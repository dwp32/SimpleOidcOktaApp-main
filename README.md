# SimpleOidcOktaApp
Really just a way to figure out single log-out (SLO).


# Using this repo
The whole point of this repo is to 1) show how to log into an app, and 2) to show how
to log out of federated systems.

First, run the "server.js" file with "node server.js" from the terminal.
To log in, go to "http://localhost:3000/".
To log out, go to "http://localhost:3000/instPlc".

## Understanding the program flow
PLC: Provisioning Login Checker

PAL: Provisioning App Logout

Since an institution federates up to CES, and CES to the Church, there must be a way to log out at
each level.  The PLC for a level generates the URL required to see if the user is logged in.  Once
the PLC link is followed, it redirects the user to the PAL, which will check for the presence of a
"code" query string parameter in the URL (which means that the user is logged in) or an "error"
query string parameter in the URL (which means that the user is NOT logged in.)  If the user does
have a session, then the PAL will redirect the user to the URL that will sign them out.

If the user was or was not signed in, they will then be directed to the PLC at the next level up,
and the process repeats.  The top level will have a redirect_uri set to the PAC so that the user
can connect their accounts properly.

## Future ideas
In the actual Provisioning App, the provisioningLink returned by the PAP (if needed) will be the
link generated by the PLC, so there will be no need for a PLC at that level.

If we could actually set the post_logout_redirect_uri as the PLC link (when going up a level),
then we could do away with all PLCs.  The problem is that Okta does not seem to like the links we
need when attempting to set them in the Sign-out redirect URI section of the application.